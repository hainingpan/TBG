function psin2=u2(vec,r,parameters)
Nvec=length(vec);
Nmax=(sqrt(Nvec/2)-1)/2;
Nrange=-Nmax:Nmax;
[h1index,h2index]=meshgrid(Nrange,Nrange);

[h1matX,h1matY]=meshgrid(h1index(:));
[h2matX,h2matY]=meshgrid(h2index(:));
h1mat=h1matX-h1matY;
h2mat=h2matX-h2matY;

for i=1:Nvec
   [ah1mat,ah2mat]=meshgrid(vec(1:(2*Nmax+1)^2,i));
   dot((h1mat(:)*parameters.b1+h2mat(:)*parameters.b2),repmat(r,(2*Nmax+1)^2,1)).*ah1mat(:).*conj(ah2mat(:));
end